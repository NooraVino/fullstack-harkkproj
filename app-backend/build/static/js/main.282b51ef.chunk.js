(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[0],{58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(4),s=n(0),r=n(1),c=n(28),i=n.n(c),u=n(5),o=n.n(u),l=n(10),j=n(12),d=n.n(j),b="/api/users",f=null,O={getUsers:function(){var e={headers:{Authorization:f}};return d.a.get(b,e).then((function(e){return e.data}))},setToken:function(e){f="bearer ".concat(e)},getOneUser:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("".concat(b,"/").concat(t," "));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getToken:function(){return f}},h=n(2),v=function(e){var t=e.setUser,n=e.user,c=Object(r.useState)([]),i=Object(a.a)(c,2),u=i[0],o=i[1];Object(h.g)();return Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var n=JSON.parse(e);t(n),O.setToken(n.token)}}),[]),Object(r.useEffect)((function(){n&&O.getUsers().then((function(e){o(e.filter((function(e){return e.id!==n.id})))}))}),[]),u&&console.log(u),Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{className:"header",children:"Kaikkien lahjatoiveet:"}),u.map((function(e){return Object(s.jsxs)("div",{className:"user",children:[Object(s.jsxs)("h3",{className:"header",children:[" ",e.username,"n toiveet"]}),Object(s.jsx)("div",{children:e.gifts.map((function(t){return Object(s.jsxs)("div",{className:"gift-item",children:[Object(s.jsxs)("div",{className:"gift-name",children:[" ",t.name]}),Object(s.jsxs)("div",{className:"gift-content",children:[" ",t.content]}),Object(s.jsx)("div",{className:"gift-url",children:Object(s.jsx)("a",{href:t.url,title:t.url,children:t.url})})]},t.id+e.id)}))})]},e.id)}))]})},p={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},m=function(e){var t=e.setUser,n=e.setLoggedUser,c=e.setGifts,i=Object(r.useState)(""),u=Object(a.a)(i,2),j=u[0],d=u[1],b=Object(r.useState)(""),f=Object(a.a)(b,2),v=f[0],m=f[1],x=Object(r.useState)(null),g=Object(a.a)(x,2),k=g[0],N=g[1],w=Object(h.g)(),S=function(){var e=Object(l.a)(o.a.mark((function e(a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,p.login({username:j,password:v});case 4:s=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(s)),O.setToken(s.token),O.getOneUser(s.id).then((function(e){t(e),c(e.gifts)})),n(s),d(""),m(""),w.push("/"),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(1),N("V\xe4\xe4r\xe4 k\xe4ytt\xe4j\xe4tunnus tai salasana"),setTimeout((function(){N(null)}),5e3),d(""),m("");case 20:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"form",children:[Object(s.jsx)("div",{className:"error",children:k}),Object(s.jsxs)("form",{onSubmit:S,children:[Object(s.jsxs)("div",{children:["K\xe4ytt\xe4j\xe4nimi",Object(s.jsx)("input",{className:"input",placeholder:"k\xe4ytt\xe4j\xe4nimi",type:"text",value:j,name:"Username",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(s.jsxs)("div",{children:["Salasana",Object(s.jsx)("input",{className:"input",placeholder:"salasana",type:"password",value:v,name:"Password",onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(s.jsx)("button",{className:"button",type:"submit",children:"Kirjaudu sis\xe4\xe4n"})]})]})},x={setNewGift:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O.getToken()}},e.next=3,d.a.post("/api/gifts",t,n);case 3:return a=e.sent,console.log(a.data),e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){var t=e.user,n=e.gifts,c=e.setGifts,i=Object(r.useState)(""),u=Object(a.a)(i,2),j=u[0],d=u[1],b=Object(r.useState)(""),f=Object(a.a)(b,2),O=f[0],v=f[1],p=Object(r.useState)(""),m=Object(a.a)(p,2),g=m[0],k=m[1],N=Object(r.useState)(null),w=Object(a.a)(N,2),S=w[0],y=w[1],U=Object(h.g)(),T=function(){var e=Object(l.a)(o.a.mark((function e(a){var s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),s=t.id,e.prev=2,e.next=5,x.setNewGift({name:j,content:O,url:g,id:s});case 5:r=e.sent,d(""),v(""),k(""),c(n.concat(r)),U.push("/"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),y("Toivetta ei voi lis\xe4t\xe4 ilman nime\xe4!"),setTimeout((function(){y(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"form",children:[Object(s.jsx)("div",{className:"error",children:S}),Object(s.jsxs)("form",{onSubmit:T,children:[Object(s.jsxs)("div",{children:["Lahjatoive",Object(s.jsx)("input",{className:"input",placeholder:"Lahjatoiveen nimi..",type:"text",value:j,name:"name",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(s.jsxs)("div",{children:["Kuvaus:",Object(s.jsx)("input",{className:"input",placeholder:"Vapaamuotoinen kuvaus..",type:"text",value:O,name:"content",onChange:function(e){var t=e.target;return v(t.value)}})]}),Object(s.jsxs)("div",{children:["Linkki:",Object(s.jsx)("input",{className:"input",placeholder:"Mahdollisia linkkej\xe4..",type:"text",value:g,name:"url",onChange:function(e){var t=e.target;return k(t.value)}})]}),Object(s.jsx)("button",{className:"button",type:"submit",children:"lis\xe4\xe4 toive"})]})]})},k=function(e){var t=e.user,n=e.gifts,a=e.setGifts;return Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"column",children:t&&n?Object(s.jsx)("div",{children:Object(s.jsx)("span",{children:n.map((function(e){return Object(s.jsxs)("div",{className:"gift-item",children:[Object(s.jsxs)("div",{className:"gift-name",children:[e.name," "]}),Object(s.jsx)("div",{className:"gift-content",children:e.content}),Object(s.jsx)("div",{className:"gift-url",children:Object(s.jsx)("a",{href:e.url,title:e.url,children:e.url})})]},e.id)}))})}):Object(s.jsx)("div",{children:"ei k\xe4ytt\xe4ji\xe4 "})}),Object(s.jsx)("div",{className:"column",children:Object(s.jsx)(g,{user:t,gifts:n,setGifts:a})})]})},N=n(11),w=(n(58),function(){var e=Object(r.useState)(null),t=Object(a.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)("muiden"),u=Object(a.a)(i,2),o=u[0],l=u[1],j=Object(r.useState)((function(){return window.localStorage.getItem("loggedUser")})),d=Object(a.a)(j,2),b=d[0],f=d[1],p=Object(r.useState)([]),x=Object(a.a)(p,2),g=x[0],w=x[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);O.setToken(t.token),O.getOneUser(t.id).then((function(e){c(e),w(e.gifts)}))}}),[]);return Object(s.jsx)("div",{children:Object(s.jsxs)(N.a,{children:[Object(s.jsx)("div",{children:b?Object(s.jsxs)("div",{className:"topnav",children:[Object(s.jsx)("button",{className:"logout-button",onClick:function(){return window.localStorage.removeItem("loggedUser"),c(null),f(null),w(null),void O.setToken(null)},children:"Kirjaudu ulos"}),Object(s.jsx)("div",{children:"muiden"===o?Object(s.jsx)(N.b,{to:"/users",className:"topnav-link",onClick:function(){return l("oma")},children:"kaikkien toiveet"}):Object(s.jsx)(N.b,{to:"/",className:"topnav-link",onClick:function(){return l("muiden")},children:"oma sivu"})})]}):Object(s.jsx)("div",{})}),Object(s.jsxs)(h.d,{children:[Object(s.jsx)(h.b,{exact:!0,path:"/users",children:b?Object(s.jsx)(v,{setUser:c,user:n}):Object(s.jsx)(h.a,{to:"/login"})}),Object(s.jsx)(h.b,{exact:!0,path:"/login",children:Object(s.jsx)(m,{setUser:c,setLoggedUser:f,setGifts:w})}),Object(s.jsx)(h.b,{exact:!0,path:"/",children:b?Object(s.jsx)(k,{user:n,gifts:g,setGifts:w}):Object(s.jsx)(h.a,{to:"/login"})})]})]})})});i.a.render(Object(s.jsx)(w,{}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.282b51ef.chunk.js.map