(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[0],{58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var s=n(5),a=n(0),r=n(1),c=n(28),i=n.n(c),u=function(e){var t=e.setPage,n=e.users;return Object(r.useEffect)((function(){t("oma")})),Object(a.jsx)("div",{children:n?Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{className:"header",children:"Kaikkien lahjatoiveet:"}),n.map((function(e){return Object(a.jsxs)("div",{className:"user",children:[Object(a.jsxs)("h3",{className:"header",children:[" ",e.username,"n toiveet"]}),Object(a.jsx)("div",{children:e.gifts.map((function(t){return Object(a.jsxs)("div",{className:"gift-item",children:[Object(a.jsxs)("div",{className:"gift-name",children:[" ",t.name]}),Object(a.jsxs)("div",{className:"gift-content",children:[" ",t.content]}),Object(a.jsx)("div",{className:"gift-url",children:Object(a.jsx)("a",{style:{display:"table-cell"},href:t.url,target:"_blank",rel:"noopener noreferrer",children:t.url})})]},t.id+e.id)}))})]},e.id)}))]}):Object(a.jsx)("div",{})})},l=n(4),o=n.n(l),j=n(10),d=n(11),b=n.n(d),f={login:function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O="/api/users",h=null,v={getUsers:function(){var e={headers:{Authorization:h}};return b.a.get(O,e).then((function(e){return e.data}))},setToken:function(e){h="bearer ".concat(e)},getOneUser:function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(O,"/").concat(t," "));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getToken:function(){return h}},p=n(2),m=function(e){var t=e.setUser,n=e.setLoggedUser,c=e.setGifts,i=e.setUsers,u=Object(r.useState)(""),l=Object(s.a)(u,2),d=l[0],b=l[1],O=Object(r.useState)(""),h=Object(s.a)(O,2),m=h[0],x=h[1],g=Object(r.useState)(null),k=Object(s.a)(g,2),N=k[0],w=k[1],y=Object(p.g)(),S=function(){var e=Object(j.a)(o.a.mark((function e(s){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,f.login({username:d,password:m});case 4:a=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(a)),v.setToken(a.token),v.getOneUser(a.id).then((function(e){t(e),c(e.gifts)})),v.getUsers().then((function(e){i(e.filter((function(e){return e.id!==a.id})))})),n(a),b(""),x(""),y.push("/"),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(1),w("V\xe4\xe4r\xe4 k\xe4ytt\xe4j\xe4tunnus tai salasana"),setTimeout((function(){w(null)}),5e3),b(""),x("");case 21:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"form",children:[Object(a.jsx)("div",{className:"error",children:N}),Object(a.jsxs)("form",{onSubmit:S,children:[Object(a.jsxs)("div",{children:["K\xe4ytt\xe4j\xe4nimi",Object(a.jsx)("input",{className:"input",placeholder:"k\xe4ytt\xe4j\xe4nimi",type:"text",value:d,name:"Username",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(a.jsxs)("div",{children:["Salasana",Object(a.jsx)("input",{className:"input",placeholder:"salasana",type:"password",value:m,name:"Password",onChange:function(e){var t=e.target;return x(t.value)}})]}),Object(a.jsx)("button",{className:"button",type:"submit",children:"Kirjaudu sis\xe4\xe4n"})]})]})},x={setNewGift:function(){var e=Object(j.a)(o.a.mark((function e(t){var n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v.getToken()}},e.next=3,b.a.post("/api/gifts",t,n);case 3:return s=e.sent,console.log(s.data),e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){var t=e.user,n=e.gifts,c=e.setGifts,i=Object(r.useState)(""),u=Object(s.a)(i,2),l=u[0],d=u[1],b=Object(r.useState)(""),f=Object(s.a)(b,2),O=f[0],h=f[1],m=Object(r.useState)(""),g=Object(s.a)(m,2),k=g[0],N=g[1],w=Object(r.useState)(null),y=Object(s.a)(w,2),S=y[0],U=y[1],T=Object(p.g)();Object(r.useEffect)((function(){t&&v.getOneUser(t.id).then((function(e){c(e.gifts)}))}));var C=function(){var e=Object(j.a)(o.a.mark((function e(s){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),a=t.id,e.prev=2,e.next=5,x.setNewGift({name:l,content:O,url:k,id:a});case 5:r=e.sent,d(""),h(""),N(""),c(n.concat(r)),T.push("/"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),U("Toivetta ei voi lis\xe4t\xe4 ilman nime\xe4!"),setTimeout((function(){U(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"form",children:[Object(a.jsx)("div",{className:"error",children:S}),Object(a.jsxs)("form",{onSubmit:C,children:[Object(a.jsxs)("div",{children:["Lahjatoive",Object(a.jsx)("input",{className:"input",placeholder:"Lahjatoiveen nimi..",type:"text",value:l,name:"name",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(a.jsxs)("div",{children:["Kuvaus:",Object(a.jsx)("input",{className:"input",placeholder:"Vapaamuotoinen kuvaus..",type:"text",value:O,name:"content",onChange:function(e){var t=e.target;return h(t.value)}})]}),Object(a.jsxs)("div",{children:["Linkki:",Object(a.jsx)("input",{className:"input",placeholder:"Mahdollisia linkkej\xe4..",type:"text",value:k,name:"url",onChange:function(e){var t=e.target;return N(t.value)}})]}),Object(a.jsx)("button",{className:"button",type:"submit",children:"Lis\xe4\xe4 toive"})]})]})},k=function(e){var t=e.user,n=e.gifts,s=e.setGifts,c=e.setPage;return Object(r.useEffect)((function(){c("muiden")}),[]),Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("h2",{className:"header",children:" Omat lahjatoiveeni:"}),Object(a.jsx)("div",{className:"column",children:t&&n?Object(a.jsx)("div",{className:"scroller",children:Object(a.jsx)("span",{children:n.map((function(e){return Object(a.jsxs)("div",{className:"gift-item",children:[Object(a.jsxs)("div",{className:"gift-name",children:[e.name," "]}),Object(a.jsx)("div",{className:"gift-content",children:e.content}),Object(a.jsx)("div",{className:"gift-url",children:Object(a.jsx)("a",{style:{display:"table-cell"},href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.url})})]},e.id)}))})}):Object(a.jsx)("div",{children:"ei k\xe4ytt\xe4ji\xe4 "})}),Object(a.jsx)("div",{className:"column",children:Object(a.jsx)(g,{user:t,gifts:n,setGifts:s})})]})},N=n(13),w=(n(58),function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(""),l=Object(s.a)(i,2),o=l[0],j=l[1],d=Object(r.useState)((function(){return window.localStorage.getItem("loggedUser")})),b=Object(s.a)(d,2),f=b[0],O=b[1],h=Object(r.useState)([]),x=Object(s.a)(h,2),g=x[0],w=x[1],y=Object(r.useState)([]),S=Object(s.a)(y,2),U=S[0],T=S[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);v.setToken(t.token),v.getOneUser(t.id).then((function(e){c(e),w(e.gifts)})),v.getUsers().then((function(e){T(e.filter((function(e){return e.id!==t.id})))}))}}),[]);return Object(a.jsx)("div",{children:Object(a.jsxs)(N.a,{children:[Object(a.jsx)("div",{children:f?Object(a.jsxs)("div",{className:"topnav",children:[Object(a.jsx)("button",{className:"logout-button",onClick:function(){return window.localStorage.removeItem("loggedUser"),c(null),O(null),w(null),j(""),T(null),void v.setToken(null)},children:"Kirjaudu ulos"}),Object(a.jsx)("div",{children:"muiden"===o?Object(a.jsx)(N.b,{to:"/users",className:"topnav-link",onClick:function(){return j("oma")},children:"Kaikkien toiveet"}):Object(a.jsx)(N.b,{to:"/",className:"topnav-link",onClick:function(){return j("muiden")},children:"Omat toiveet"})})]}):Object(a.jsx)("div",{})}),Object(a.jsxs)(p.d,{children:[Object(a.jsx)(p.b,{exact:!0,path:"/users",children:f?Object(a.jsx)(u,{setUser:c,user:n,setPage:j,users:U}):Object(a.jsx)(p.a,{to:"/login"})}),Object(a.jsx)(p.b,{exact:!0,path:"/login",children:Object(a.jsx)(m,{setUser:c,setLoggedUser:O,setGifts:w,setUsers:T})}),Object(a.jsx)(p.b,{exact:!0,path:"/",children:f?Object(a.jsx)(k,{user:n,gifts:g,setGifts:w,setPage:j}):Object(a.jsx)(p.a,{to:"/login"})})]})]})})});i.a.render(Object(a.jsx)(w,{}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.af81f7ed.chunk.js.map